// @flow

const debug = require('debug')('text-stream-accumulator')

module.exports = class TextStreamAccumulator {
  _accumulatedText: string

  constructor (stream: stream$Readable) {
    // the text that was been accumulated so far
    this._accumulatedText = ''
    stream.on('data', this._onStreamData.bind(this))
  }

  // Called when new text arrives
  _onStreamData (data: Buffer) {
    const text = data.toString()
    debug(`receiving data: ${text}`)
    this._accumulatedText += text
  }

  toString () {
    return this._accumulatedText
  }

  reset () {
    debug('reseting accumulated text')
    this._accumulatedText = ''
  }
}
